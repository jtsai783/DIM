<link rel="import" href="../bower_components/polymer/polymer.html">
<script src="../bower_components/Chart.HorizontalBar.js/Chart.HorizontalBar.js"></script>
<dom-module id="item-card">
	


	<template>
		<style>
			:host {
				display: block;
			}
			.outer{
				margin: 20px;
				height: 250px;
				background-color: rgba(107, 107, 107, 0.4);
				width: calc(100%-20px);
			}
			.inline {
				display: inline-block;
			}

			.chart {
				width: 50%;
				height: 100%;
			}
		</style>

		<div class="outer">
			<img src="{{itemIcon(item.icon)}}">
			<canvas id="stats" class="chart"></canvas>
		</div>
	</template>

	<script>
	Polymer({
		is: "item-card",
		properties: {
			item: Object,
			maxval: Number
		},
		itemIcon: function(iconFilename){
			return "../icons/" + iconFilename;
		},
		ready: function(){
			var labels = _.keys(this.item.hiddenStats).reverse().concat(_.keys(this.item.stats).reverse());
			labels = _.map(labels, function(label){
				return label.toUpperCase();
			});
			var data = {
				labels: labels,
				datasets: [
					{
						fillColor: "rgba(255,255,255, 1)",
						data: _.values(this.item.hiddenStats).reverse().concat(_.values(this.item.stats).reverse())
					}
				]
			};
			var ctx = this.$.stats.getContext("2d");
			var newChart = null;
			var chartOptions = {
				scaleOverride: true,
				scaleSteps: Math.ceil(this.maxval/10),
				scaleStepWidth: 10,
				scaleStartValue: 0,
				scaleGridLineColor : "rgba(255,255,255,.05)",
				barValueSpacing : 1
			};
			setTimeout(function() {
			    newChart = new Chart(ctx).HorizontalBar(data, chartOptions);
			}, 0);
		}
	});
	</script>
</dom-module>