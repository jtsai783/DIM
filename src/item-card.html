<link rel="import" href="../bower_components/polymer/polymer.html">


<dom-module id="item-card">
	


	<template>
		<style>
			:host {
				display: inline-block;
				min-width: 150px;
			}
			.outer{
				margin: 10px;
				background-color: rgba(107, 107, 107, 0.4);
				width: calc(100%-10px);
			}
			.chart {
				padding: 10px;
				display: block;
			}
		</style>

		<div class="outer">
			<img src="{{itemIcon(item.icon)}}">
			<canvas id="stats" class="chart"></canvas>
			<canvas id="hiddenstats" class="chart"></canvas>
		</div>
	</template>

	<script>
	Polymer({
		is: "item-card",
		properties: {
			item: Object,
			maxval: Number
		},
		itemIcon: function(iconFilename){
			return "../icons/" + iconFilename;
		},
		ready: function(){
			this.drawStat();
			this.drawHiddenStat();
		},
		drawStat: function() {
			var labels = _.keys(this.item.stats).reverse();
			labels = _.map(labels, function(label){
				return label.toUpperCase();
			});
			var data = {
				labels: labels,
				datasets: [
					{
						fillColor: "rgba(255,255,255, 0.2)",
						strokeColor: "rgba(255,255,255, 1)",
						data: _.values(this.item.stats).reverse()
					},
				]
			};
			var ctx = this.$.stats.getContext("2d");
			var newChart = null;
			var chartOptions = {
				scaleOverride: true,
				scaleSteps: Math.ceil(this.maxval/10),
				scaleStepWidth: 10,
				scaleStartValue: 0,
				datasetStrokeWidth : 2,
				angleLineColor : "rgba(255,255,255,0.5)",
				scaleLineColor: "rgba(255,255,255,0.5)",
				pointLabelFontColor : "#FFF",
			};
			setTimeout(function() {
			    newChart = new Chart(ctx).Radar(data, chartOptions);
			}, 0);
		},
		drawHiddenStat: function() {
			var labels = _.keys(this.item.hiddenStats).reverse();
			labels = _.map(labels, function(label){
				return label.toUpperCase();
			});
			var data = {
				labels: labels,
				datasets: [
					{
						fillColor: "rgba(255,255,255, 0.2)",
						strokeColor: "rgba(255,255,255, 1)",
						data: _.values(this.item.hiddenStats).reverse()
					},
				]
			};
			var ctx = this.$.hiddenstats.getContext("2d");
			var newChart = null;
			var chartOptions = {
				scaleOverride: true,
				scaleSteps: Math.ceil(this.maxval/10),
				scaleStepWidth: 10,
				scaleStartValue: 0,
				datasetStrokeWidth : 2,
				angleLineColor : "rgba(255,255,255,0.5)",
				scaleLineColor: "rgba(255,255,255,0.5)",
				pointLabelFontColor : "#FFF",
			};
			setTimeout(function() {
			    newChart = new Chart(ctx).Radar(data, chartOptions);
			}, 0);
		}
	});
	</script>
</dom-module>